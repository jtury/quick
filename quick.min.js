// Â©2021 James Tury. Licensed under the MIT license. Contribute at https://github.com/jtury/quick
let httpRequest,c=[];const p=new DOMParser;function fetch_information(e){if(c.findIndex(n=>n[0].includes(e))===-1){if(e+="/index.html",httpRequest=new XMLHttpRequest,!httpRequest){return!1}httpRequest.onreadystatechange=function(){if(httpRequest.readyState===XMLHttpRequest.DONE){if(httpRequest.status===200){c.push([httpRequest.responseURL.replace("index.html",""),{title:p.parseFromString(httpRequest.responseText,"text/html").getElementsByTagName("title")[0].innerHTML,page_content:p.parseFromString(httpRequest.responseText,"text/html").getElementById("page").innerHTML}])}else{return alert("Something went wrong. Try disabling javascript and try again."),!1}}},httpRequest.open("GET",e),httpRequest.send()}return!0}function special_keys(e){return e.shiftKey||e.ctrlKey||e.altKey||e.metaKey}function attach_hooks(){Array.from(document.getElementsByTagName("a")).forEach(t=>{t.href&&new URL(t.href).origin===location.origin&&(t.addEventListener("pointerenter",function(){setTimeout(function(){t.matches(":hover")&&fetch_information(t.href)},85)}),t.addEventListener("pointerdown",function(n){special_keys(n)||(n.preventDefault(),fetch_information(t.href))}),t.addEventListener("click",function(n){if(!special_keys(n)){if(n.preventDefault(),fetch_information(t.href)===!0){let i=t.href;display_page(c.findIndex(r=>r[0].includes(i)))}else{window.location=t.href}}}))})}function init(){c.push([document.location.href,{title:document.title,page_content:document.getElementById("page").innerHTML}]);let e=c[0][0],t=c[0][1].title,n=c[0][1].page_content;window.history.replaceState({title:t,html:n},t,e),attach_hooks()}function display_page(e){let t=c[e][0],n=c[e][1].title,i=c[e][1].page_content;document.title=n,document.getElementById("page").innerHTML=i,window.history.pushState({title:n,html:i},n,t)}window.onpopstate=function(e){let t=JSON.stringify(e.state);t!=="null"&&(t=JSON.parse(t),document.title=t.title,document.getElementById("page").innerHTML=t.html,attach_hooks())};